<html>
<head>
	<!-- Block Editor plugin -->
	<link rel="stylesheet" href="null.css" type="text/css" title="Default">
	<link rel="stylesheet" href="block-editor/external/font-awesome-4.3.0/css/font-awesome.min.css" type="text/css">
	<link rel="stylesheet" href="block-editor/css/block_editor.css" type="text/css">
	<script type="text/javascript" src="block-editor/external/jquery.js"></script>
	<script type="text/javascript" src="block-editor/external/gettext.js"></script>
	<script type="text/javascript" src="block-editor/external/c2s.js"></script>
	<script type="text/javascript" src="block-editor/js/classes/storage.js"></script>
	<script type="text/javascript" src="block-editor/js/classes/geometry.js"></script>
	<script type="text/javascript" src="block-editor/js/classes/grid.js"></script>
	<script type="text/javascript" src="block-editor/js/classes/astar.js"></script>
	<script type="text/javascript" src="block-editor/js/classes/spline.js"></script>
	<script type="text/javascript" src="block-editor/js/classes/block.js"></script>
	<script type="text/javascript" src="block-editor/js/classes/placeholder.js"></script>
	<script type="text/javascript" src="block-editor/js/classes/editor.js"></script>
	<script type="text/javascript" src="block-editor/js/classes/parent_editor.js"></script>
	<script type="text/javascript" src="block-editor/js/classes/block_editor.js"></script>
	<script type="text/javascript" src="block-editor/js/classes/canvas.js"></script>
	<script type="text/javascript" src="block-editor/js/classes/toolbar.js"></script>
	<script type="text/javascript" src="block-editor/js/classes/palette.js"></script>
	<script type="text/javascript" src="block-editor/js/block_editor.js"></script>

	<style type="text/css">
		.block-editor {
			position: absolute;
			margin: 0px;
			padding: 0px;
			top: 0px;
			left: 0px;
			width: 100%;
			height: 100%;
			border: none;
		}
	</style>
</head>
<body>
	<textarea name="cfg" id="editor" class="block_editor_widget" rows="25" cols="80"
		data-doc_link="/admin/doc/block/{block}"
		data-edit_link="/admin/block-editor/{block}"
	></textarea>

	<script type="text/javascript">

		// Load data
		var editor = document.getElementById("editor");
		editor.value = WebWrap.editorData;

		// Watch for change of editor data (file loaded or something)
		WebWrap.editorDataChanged.connect(function(data) {
			editor.value = data;
			editor.onchange();
		});

		// Update data when changed by editor
		editor.onchange = function(event) {
			if (WebWrap.editorData != editor.value) {
				WebWrap.editorData = editor.value;
				WebWrap.modified = true;
			}
		};

		// Setup editor
		console.log(jQuery('textarea#editor').blockEditor({
			paletteData: "block-editor/examples/palette.json",
			onInit: function(widget) {
				WebWrap.tips.connect(function(checked) { widget.toggleHelp(checked); });
				WebWrap.tipsAvailable(true);
			},
			onHelpToggle: function(visible) {
				WebWrap.tipsChecked(visible);
			}
		}));

	</script>
</body>
</html>
